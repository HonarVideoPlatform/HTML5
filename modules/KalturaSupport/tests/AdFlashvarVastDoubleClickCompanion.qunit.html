<html>
<head>
<title>VAST flashvar DoubleClick Ad and Companion </title>
<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
<script type="text/javascript">	
function jsKalturaPlayerTest( videoId ){
	
	// Name this module
	module( "VAST flashvar DoubleClick Ad and Companion " );
	var kdp = $('#' + videoId ).get(0);
	
	asyncTest("VAST DoubleClick Ad", function(){
		kalturaQunitWaitForPlayer(function(){
			kdp.sendNotification( 'doPlay' );
			// wait for 10 seconds given time
			var waitTries = 0;
			waitForCompanions = function(){
				if( waitTries > 100 ){
					ok( false, "No companions after 10 seconds" );
					start();
					return ;
				}
				if( $('#testLongCompanion').find('a').length && 
					$('#testCompanion').find('a').length ){
					equal( $('#testLongCompanion').find('a').attr('href'), "http://www.google.com", "testLongCompanion updated link" );
					equal( $('#testCompanion').find('a').attr('href'), "http://www.google.com", "testCompanion updated link" );
					kdp.sendNotification( 'doPause' );
					start();
					return ;
				}
				// increment wait count
				waitTries++;
				// Else loop: 
				setTimeout( waitForCompanions, 100 );
			}
			// give the player time for attribute sync cyle ( happens every 250ms )
			setTimeout( waitForCompanions, 300 );
		});
	});

}
</script>
<!-- qunit-kaltura must come after qunit-bootstrap.js and after mwEmbedLoader.php and after any jsCallbackReady stuff-->
<script type="text/javascript" src="resources/qunit-kaltura-bootstrap.js"></script>
</head>
<body>
<h2> VAST flashvar DoubleClick Ad and Companion </h2>
<a href="http://ad.doubleclick.net/pfadx/AngelaSite;kw=html5linearnonlinear;sz=300x300;ord=5036130;dcmt=text/xml">DoubleClick VAST</a> <br/>
<a href="?forceMobileHTML5"> Force Mobile HTML5</a> for testing with desktop chrome and safari.
<br />
<div id="testLongCompanion" style="width:728px;height:90px;;border:solid thin black;padding:5px;margin:5px;"> ( long companion target )</div>
<br />
<div id="testCompanion" style="width:300px;height:250px;float:left;border:solid thin black;padding:5px;margin:5px;"> ( companion target ) </div>

<object id="kaltura_player_1312423631" 
name="kaltura_player_1312423631" 
type="application/x-shockwave-flash" 
allowFullScreen="true" 
allowNetworking="all" 
allowScriptAccess="always" 
height="333" width="400" bgcolor="#000000" 
xmlns:dc="http://purl.org/dc/terms/" 
xmlns:media="http://search.yahoo.com/searchmonkey/media/" 
rel="media:video" 
resource="http://www.kaltura.com/index.php/kwidget/cache_st/1312423631/wid/_243342/uiconf_id/5349042/entry_id/0_swup5zao" 
data="http://www.kaltura.com/index.php/kwidget/cache_st/1312423631/wid/_243342/uiconf_id/5349042/entry_id/0_swup5zao">
	<param name="allowFullScreen" value="true" />
	<param name="allowNetworking" value="all" />
	<param name="allowScriptAccess" value="always" />
	<param name="bgcolor" value="#000000" />
	<param name="flashVars" value="&vast.plugin=true&vast.numPreroll=1&vast.prerollInterval=1&vast.prerollstartwith=1&vast.prerollUrl=http://ad.doubleclick.net/pfadx/AngelaSite;kw=html5linearnonlinear;sz=300x300;ord=5036130;dcmt=text/xml&vast.presequence=1&vast.timeout=4&vast.htmlCompanions=testCompanion:300:250;testLongCompanion:728:90;" />
	<param name="movie" value="http://www.kaltura.com/index.php/kwidget/cache_st/1312423631/wid/_243342/uiconf_id/5349042/entry_id/0_swup5zao" />
</object>
</body>
</html>