<!DOCTYPE HTML>
<html>
<head>
<title>TTML Captions Custom vars</title>
<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
<script type="text/javascript">	
function jsKalturaPlayerTest( videoId ){
	var kdp = $( '#' + videoId ).get(0);
	// Name this module
	module( "TTML Captions Custom vars" );

	var $iframe = $('#' + videoId + '_ifp').contents();
	var iframeKdp = $iframe.find( '#' + videoId ).get(0);
	var iframeContext = window.frames['kaltura_player_ifp'];
	
	asyncTest( "Timed text on screen", function() {
		kalturaQunitWaitForPlayer(function(){
			// Setup text:
			iframeKdp.timedText.setupTextSources(function(){
				ok( iframeKdp.timedText.textSources.length, "Text sources found" );
				kdp.sendNotification( 'doPlay' );
				setTimeout(function(){
					// Check that the text is displayed: 
					kdp.sendNotification( 'doSeek', 2);
					kdp.sendNotification( 'doPause', 2);

					kdp.sendNotification( 'doSeek', 2);
					setTimeout(function(){
						ok( $iframe.find('.track').length, "text container in DOM");
						equal( $iframe.find('.track').text(), "ALIGN RIGHT. ROW 0 COL 10 Line Break.", "Text matches ttml");
						start();
					}, 500 );
				},500);

				// give the player 1 second to do the seek 
				//( the seek should update the time before the player acutally gets there )
				
				
			});
		});
	});
}
</script>
<!-- qunit-kaltura must come after qunit-bootstrap.js and after mwEmbedLoader.php and after any jsCallbackReady stuff-->
<script type="text/javascript" src="resources/qunit-kaltura-bootstrap.js"></script>
</head>
<body>
<h2>TTML Captions Custom vars </h2>
<a href="?forceMobileHTML5"> Force Mobile Safari</a> for testing with desktop chrome and safari.
<br /><br />
<a href="http://www.kaltura.org/apis/html5lib/mwEmbed/modules/KalturaSupport/tests/resources/FishTmmlFeatureTest.en.xml"> TTML XML being displayed</a>
<br /><br />
<div style="float:left">
	<object id="kaltura_player_1311374779" name="kaltura_player_1311374779" type="application/x-shockwave-flash" allowFullScreen="true" allowNetworking="all" allowScriptAccess="always" height="330" width="400" bgcolor="#000000" xmlns:dc="http://purl.org/dc/terms/" xmlns:media="http://search.yahoo.com/searchmonkey/media/" rel="media:video" resource="http://www.kaltura.com/index.php/kwidget/cache_st/1311374779/wid/_243342/uiconf_id/5260062/entry_id/0_swup5zao" data="http://www.kaltura.com/index.php/kwidget/cache_st/1311374779/wid/_243342/uiconf_id/5260062/entry_id/0_swup5zao"><param name="allowFullScreen" value="true" /><param name="allowNetworking" value="all" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="#000000" /><param name="flashVars" value="&" /><param name="movie" value="http://www.kaltura.com/index.php/kwidget/cache_st/1311374779/wid/_243342/uiconf_id/5260062/entry_id/0_swup5zao" /><a href="http://corp.kaltura.com">video platform</a> <a href="http://corp.kaltura.com/video_platform/video_management">video management</a> <a href="http://corp.kaltura.com/solutions/video_solution">video solutions</a> <a href="http://corp.kaltura.com/video_platform/video_publishing">video player</a> <a rel="media:thumbnail" href="http://cdnbakmi.kaltura.com/p/243342/sp/24334200/thumbnail/entry_id/0_swup5zao/width/120/height/90/bgcolor/000000/type/2"></a> <span property="dc:description" content="test fish desc  ( test longer description for this asset very very long description is listed here since we are dealing with a description property"></span><span property="media:title" content="Fish web quality video ( test longer description for this as"></span> <span property="media:width" content="400"></span><span property="media:height" content="330"></span> <span property="media:type" content="application/x-shockwave-flash"></span> </object>
</div>
</body>
</html>
